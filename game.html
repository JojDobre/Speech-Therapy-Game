<!DOCTYPE html>
<html lang="sk">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <meta name="description" content="Logopedick√° hra pre najmen≈°√≠ch">
  <meta name="author" content="Adam Re≈àak">
  <meta name="keywords" content="Adam Re≈àak, Joj_Dobre, Bakal√°rska pr√°ca, Logopedick√° hra,">
  <title>Ban√≠kovo dobrodru≈æstvo: Rozv√≠janie reƒçi - Bakal√°rska pr√°ca</title>
  <link rel="stylesheet" type="text/css" href="index.css" />

  <link rel="icon" type="image/png" href="images/banik.ico">
  <link rel="shortcut icon" href="images/icons/banik.ico">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/howler/2.2.3/howler.min.js"></script>

  <style>
  canvas {
    display: block;
    margin: 0 auto;
    border: 1px solid #000;
    justify-content: center;
    align-items: center;
  }
  
  /* Nov√Ω ≈°t√Ωl pre navig√°ciu */
  .game-navigation {
    position: fixed;
    top: 10px;
    left: 10px;
    z-index: 1000;
    display: flex;
    gap: 10px;
  }
  
  .nav-button {
    background: rgba(0, 0, 0, 0.7);
    color: white;
    border: none;
    padding: 8px 12px;
    border-radius: 5px;
    cursor: pointer;
    font-size: 12px;
    transition: background 0.3s ease;
  }
  
  .nav-button:hover {
    background: rgba(0, 0, 0, 0.9);
  }
  
  /* Level info panel */
  .level-info-panel {
    position: fixed;
    top: 10px;
    right: 10px;
    background: rgba(0, 0, 0, 0.8);
    color: white;
    padding: 10px 15px;
    border-radius: 8px;
    font-family: 'MPLUSRounded1c-Medium', Arial, sans-serif;
    font-size: 14px;
    z-index: 1000;
    border: 2px solid #4CAF50;
  }
  
  .level-info-panel h3 {
    margin: 0 0 5px 0;
    font-size: 16px;
    color: #4CAF50;
  }
  
  .level-info-panel p {
    margin: 2px 0;
    font-size: 12px;
  }
  </style>
</head>
<body>
  <!-- Navig√°cia -->
  <div class="game-navigation">
    <button class="nav-button" onclick="pauseGame()" id="pauseBtn">‚è∏Ô∏è Pauza</button>
    <button class="nav-button" onclick="returnToLevelSelector()">‚Üê Sp√§≈•</button>
    <button class="nav-button" onclick="restartLevel()">üîÑ Restart</button>
  </div>

  <!-- Info panel o leveli -->
  <div class="level-info-panel" id="levelInfoPanel" style="display: none;">
    <h3 id="levelTitle">Level 1</h3>
    <p>Svet: <span id="worldName">R</span></p>
    <p>Typ: <span id="gameType">Ban√≠k</span></p>
    <p id="timeDisplay" style="display: none;">ƒåas: <span id="timeValue">0:00</span></p>
  </div>

  <!-- Hlavn√° hra -->
  <div class="hra">
   <div class="menu-hra">
    <button onclick="openDialog1()" class="kruhove-tlacidlo" id="menuButton"></button>
    
    <div class="menu-golds">
      <h1></h1><div class="golds-container"></div>
    </div>
    <div class="menu-diamonds">
      <h1></h1><div class="diamonds-container"></div>
    </div>
    <div class="menu-kov">
      <h1></h1><div class="kov-container"></div>
    </div>
   </div>
   <canvas id="gameCanvas" width="800" height="800"></canvas>
  </div>
  
  <!-- Reƒçov√© cviƒçenie -->
  <div id="cvicenie" class="cvicenie">
    <div id="vysledok" class="vysledok"></div>
    <div class="cvicenie-content">
      <center><img id="cvicenie-image" src="images/slova/traktor.png" alt="Obr√°zok" style="width: 240px; height: auto; display: block; margin-top: 20px; "></center>
      <p class="cvicenie-text" id="word-display" style="text-align: center;">TRAKTOR</p>
      <center><button id="rozpoznanie" class="tlacidlo">KLIKNITE PRE NAHR√ÅVANIE</button></center>
    </div>
  </div>

  <!-- Posluchov√© cviƒçenie -->
  <div id="zvuky" class="cvicenie">
    <div class="cvicenie-content-2">
      <h1>ROZPOZNAJ SLOV√Å</h1>
      <p>S√∫ slov√° rovnak√©?</p>
      <div id="buttonsContainer"></div>
    </div>
  </div>

  <!-- End game dialog - Aktualizovan√Ω pre level syst√©m -->
  <div id="endgame" class="cvicenie">
    <div class="cvicenie-content">
      <p>VYHRAL SI HRU!</p>
      <p style="font-size: 20px;">Chce≈° pokraƒçova≈•?</p>
      <div class="gameend">
        <!-- Tlaƒçidl√° sa vygeneruj√∫ dynamicky cez JavaScript v completeLevel() -->
      </div>
    </div>
  </div>

  <!-- Menu dialog -->
  <div id="dialogove-okno" class="dialogove-okno">
    <div class="dialogove-okno-content">
      <span class="close" onclick="closeDialog1()">&times;</span>
      <div class="menu-buttons">
        <button class="nav-button" onclick="returnToLevelSelector()" style="margin: 10px; padding: 15px 25px; font-size: 16px; display: block; width: 200px;">
          üè† Sp√§≈• na levely
        </button>
        <button class="nav-button" onclick="restartLevel()" style="margin: 10px; padding: 15px 25px; font-size: 16px; display: block; width: 200px;">
          üîÑ Restart level
        </button>
        <button class="nav-button" onclick="returnToWorldsMenu()" style="margin: 10px; padding: 15px 25px; font-size: 16px; display: block; width: 200px;">
          üåç Menu svetov
        </button>
      </div>
    </div>
  </div>

  <!-- Mobiln√© ovl√°danie -->
  <div class="joystick">
    <div id="pickaxe" class="tool">ü™ì</div>
  </div>
  
  <div class="controls">
    <div id="up" class="arrow">&#9650;</div>
    <div id="left" class="arrow">&#9664;</div>
    <div id="down" class="arrow">&#9660;</div>
    <div id="right" class="arrow">&#9654;</div>
  </div>

  <!-- Blur pozadie -->
  <div id="blur-background"></div>

  <!-- JavaScript s√∫bory - v spr√°vnom porad√≠ -->
  <!-- Bezpeƒçn√© naƒç√≠tanie config s√∫borov -->
  <script>
    // Pomocn√° funkcia pre bezpeƒçn√© naƒç√≠tanie skriptov
    function loadScript(src) {
      return new Promise((resolve, reject) => {
        const script = document.createElement('script');
        script.src = src;
        script.onload = resolve;
        script.onerror = () => {
          console.log(`S√∫bor ${src} sa nepodarilo naƒç√≠ta≈•`);
          resolve(); // Pokraƒçuj aj pri chybe
        };
        document.head.appendChild(script);
      });
    }

    // Naƒç√≠taj config s√∫bory ak existuj√∫
    Promise.all([
      loadScript('config/worlds.js'),
      loadScript('config/levels.js'),
      loadScript('js/managers/progressManager.js'),
      loadScript('js/managers/gameRouter.js')
    ]).then(() => {
      console.log('Config s√∫bory naƒç√≠tan√© (alebo preskoƒçen√©)');
      
      // Naƒç√≠taj hlavn√∫ hru a≈æ po config s√∫boroch
      loadScript('js/game.js').then(() => {
        console.log('Hra naƒç√≠tan√°');
      });
    });
  </script>

  <script>
    // Menu funkcie
    function openDialog1() {
      document.getElementById("dialogove-okno").style.display = "block";
      document.getElementById("blur-background").style.display = "block";
      document.body.classList.add("dialog-open");
      document.body.style.overflow = "hidden";
    }

    function closeDialog1() {
      document.getElementById("dialogove-okno").style.display = "none";
      document.getElementById("blur-background").style.display = "none";
      document.body.classList.remove("dialog-open");
      document.body.style.overflow = "auto";
    }

    // Pauza hry
    function pauseGame() {
      if (window.gameState) {
        window.gameState.isPaused = !window.gameState.isPaused;
        const pauseBtn = document.getElementById('pauseBtn');
        if (window.gameState.isPaused) {
          pauseBtn.textContent = '‚ñ∂Ô∏è Pokraƒçova≈•';
          pauseBtn.style.backgroundColor = '#4CAF50';
        } else {
          pauseBtn.textContent = '‚è∏Ô∏è Pauza';
          pauseBtn.style.backgroundColor = 'rgba(0, 0, 0, 0.7)';
        }
      }
    }

    // Aktualiz√°cia level info panelu
    function updateLevelInfoPanel() {
      if (window.gameState && window.gameState.levelConfig) {
        const panel = document.getElementById('levelInfoPanel');
        const levelConfig = window.gameState.levelConfig;
        const worldConfig = window.gameState.worldConfig;
        
        document.getElementById('levelTitle').textContent = levelConfig.name || 'Level';
        
        if (worldConfig) {
          document.getElementById('worldName').textContent = worldConfig.title || worldConfig.name || 'Svet';
        }
        
        document.getElementById('gameType').textContent = 'Ban√≠k';
        
        // Zobraz ƒçasov√Ω limit ak existuje
        if (levelConfig.timeLimit) {
          const timeDisplay = document.getElementById('timeDisplay');
          timeDisplay.style.display = 'block';
          
          // Spusti aktualiz√°ciu ƒçasu
          setInterval(() => {
            if (window.getCurrentGameTime) {
              const time = window.getCurrentGameTime();
              const minutes = Math.floor(time / 60);
              const seconds = time % 60;
              document.getElementById('timeValue').textContent = 
                `${minutes}:${seconds.toString().padStart(2, '0')}`;
            }
          }, 1000);
        }
        
        panel.style.display = 'block';
      }
    }

    // Spusti aktualiz√°ciu panelu po naƒç√≠tan√≠ hry
    document.addEventListener('DOMContentLoaded', () => {
      setTimeout(() => {
        updateLevelInfoPanel();
      }, 2000); // Poƒçkaj k√Ωm sa naƒç√≠ta level config
    });

    // Skrytie level info panelu po kliknut√≠
    document.getElementById('levelInfoPanel')?.addEventListener('click', function() {
      this.style.display = 'none';
    });

    // Debug funkcie pre testovanie
    window.addEventListener('keydown', (e) => {
      // Ctrl+L pre zobrazenie level info
      if (e.ctrlKey && e.key === 'l') {
        e.preventDefault();
        console.log('Level Config:', window.gameState?.levelConfig);
        console.log('World Config:', window.gameState?.worldConfig);
        console.log('Current Level Words:', window.currentLevelWords);
      }
      
      // Ctrl+W pre simul√°ciu v√Ωhry
      if (e.ctrlKey && e.key === 'w') {
        e.preventDefault();
        if (window.completeLevel) {
          window.completeLevel();
        }
      }
    });
  </script>
</body>
</html>
